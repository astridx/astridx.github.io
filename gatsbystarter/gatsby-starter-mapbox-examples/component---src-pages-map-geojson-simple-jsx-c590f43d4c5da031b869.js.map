{"version":3,"sources":["webpack:///./src/pages/map-geojson-simple.jsx","webpack:///./node_modules/mapbox-gl-style-switcher/dist/index.js","webpack:///./node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/createClass.js","webpack:///./src/components/Map/StyleSelector.jsx","webpack:///./src/components/Map/index.jsx","webpack:///./src/components/Map/util.js","webpack:///./node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/classCallCheck.js"],"names":["sources","dreieck","type","data","coordinates","layers","id","source","paint","MapPage","title","_classCallCheck","_createClass","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","length","i","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","arr","len","arr2","defineProperty","exports","MapboxStyleSwitcherControl","styles","defaultStyle","this","DEFAULT_STYLES","DEFAULT_STYLE","onDocumentClick","bind","key","map","_this","controlContainer","document","createElement","classList","add","mapStyleContainer","styleButton","_step","_iterator","style","styleElement","innerText","replace","dataset","uri","JSON","stringify","addEventListener","event","srcElement","contains","setStyle","parse","display","elms","getElementsByClassName","remove","appendChild","parentNode","removeEventListener","removeChild","undefined","target","_defineProperties","props","descriptor","enumerable","configurable","writable","module","Constructor","protoProps","staticProps","Wrapper","styled","div","Basemap","img","isActive","themeGet","size","css","getSrc","styleID","z","x","y","token","StyleSelector","tile","onChange","console","log","on","useState","basemap","setBasemap","isOpen","setIsOpen","baseStyleRef","useRef","once","current","fromJS","getStyle","handleBasemapClick","newBasemap","baseStyle","snapshot","baseSources","get","baseLayers","userSources","filter","_","has","userLayers","layer","includes","forEach","addSource","toJS","addLayer","toggleOpen","nextBasemap","src","onClick","onMouseEnter","onMouseLeave","defaultProps","Plugin","position","onAdd","container","float","cursor","render","init","onRemove","width","height","Map","zoom","center","bounds","padding","minZoom","maxZoom","directions","scale","styleSwitcher","layerSwitcher","mapboxToken","siteMetadata","error","hasWindow","mapNode","mapRef","useEffect","mapCenter","mapZoom","viewport","geoViewport","Math","max","getCenterAndZoom","mapboxgl","accessToken","window","addControl","NavigationControl","direction","entries","directionData","pois","poi","Marker","setLngLat","setPopup","Popup","offset","setText","addTo","MapboxDirections","setOrigin","origin","setDestination","destination","ScaleControl","maxWidth","unit","ss","ls","ref","instance"],"mappings":"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","file":"component---src-pages-map-geojson-simple-jsx-c590f43d4c5da031b869.js","sourcesContent":["import React from 'react'\n\nimport Layout from 'components/Layout'\nimport Map from 'components/Map'\n\nconst sources = {\n  dreieck: {\n    type: 'geojson',\n    data: {\n      type: 'Polygon',\n      coordinates: [[[7.03, 50.19], [7.58, 50.39], [7.18, 50.29]]],\n    },\n  },\n}\n\nconst layers = [\n  {\n    id: '1',\n    source: 'dreieck',\n    type: 'fill',\n    paint: {\n      'fill-color': 'red',\n      'fill-opacity': 0.5,\n    },\n  },\n]\n\nconst MapPage = () => {\n  return (\n    <Layout title=\"Full Screen Map with GeoJSON\">\n      <Map sources={sources} layers={layers} />\n    </Layout>\n  )\n}\n\nexport default MapPage\n","\"use strict\";\n\nvar _classCallCheck = require(\"/home/astrid/git/javascript/gatsby_plugins_starter/gitrepos/gatsby-starter-mapbox-examples/node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/astrid/git/javascript/gatsby_plugins_starter/gitrepos/gatsby-starter-mapbox-examples/node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/createClass\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar MapboxStyleSwitcherControl = /*#__PURE__*/function () {\n  function MapboxStyleSwitcherControl(styles, defaultStyle) {\n    _classCallCheck(this, MapboxStyleSwitcherControl);\n\n    this.styles = styles || MapboxStyleSwitcherControl.DEFAULT_STYLES;\n    this.defaultStyle = defaultStyle || MapboxStyleSwitcherControl.DEFAULT_STYLE;\n    this.onDocumentClick = this.onDocumentClick.bind(this);\n  }\n\n  _createClass(MapboxStyleSwitcherControl, [{\n    key: \"getDefaultPosition\",\n    value: function getDefaultPosition() {\n      var defaultPosition = \"top-right\";\n      return defaultPosition;\n    }\n  }, {\n    key: \"onAdd\",\n    value: function onAdd(map) {\n      var _this = this;\n\n      this.map = map;\n      this.controlContainer = document.createElement(\"div\");\n      this.controlContainer.classList.add(\"mapboxgl-ctrl\");\n      this.controlContainer.classList.add(\"mapboxgl-ctrl-group\");\n      this.mapStyleContainer = document.createElement(\"div\");\n      this.styleButton = document.createElement(\"button\");\n      this.styleButton.type = \"button\";\n      this.mapStyleContainer.classList.add(\"mapboxgl-style-list\");\n\n      var _iterator = _createForOfIteratorHelper(this.styles),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var style = _step.value;\n          var styleElement = document.createElement(\"button\");\n          styleElement.type = \"button\";\n          styleElement.innerText = style.title;\n          styleElement.classList.add(style.title.replace(/[^a-z0-9-]/gi, '_'));\n          styleElement.dataset.uri = JSON.stringify(style.uri);\n          styleElement.addEventListener(\"click\", function (event) {\n            var srcElement = event.srcElement;\n\n            if (srcElement.classList.contains(\"active\")) {\n              return;\n            }\n\n            _this.map.setStyle(JSON.parse(srcElement.dataset.uri));\n\n            _this.mapStyleContainer.style.display = \"none\";\n            _this.styleButton.style.display = \"block\";\n\n            var elms = _this.mapStyleContainer.getElementsByClassName(\"active\");\n\n            while (elms[0]) {\n              elms[0].classList.remove(\"active\");\n            }\n\n            srcElement.classList.add(\"active\");\n          });\n\n          if (style.title === this.defaultStyle) {\n            styleElement.classList.add(\"active\");\n          }\n\n          this.mapStyleContainer.appendChild(styleElement);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.styleButton.classList.add(\"mapboxgl-ctrl-icon\");\n      this.styleButton.classList.add(\"mapboxgl-style-switcher\");\n      this.styleButton.addEventListener(\"click\", function () {\n        _this.styleButton.style.display = \"none\";\n        _this.mapStyleContainer.style.display = \"block\";\n      });\n      document.addEventListener(\"click\", this.onDocumentClick);\n      this.controlContainer.appendChild(this.styleButton);\n      this.controlContainer.appendChild(this.mapStyleContainer);\n      return this.controlContainer;\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove() {\n      if (!this.controlContainer || !this.controlContainer.parentNode || !this.map || !this.styleButton) {\n        return;\n      }\n\n      this.styleButton.removeEventListener(\"click\", this.onDocumentClick);\n      this.controlContainer.parentNode.removeChild(this.controlContainer);\n      document.removeEventListener(\"click\", this.onDocumentClick);\n      this.map = undefined;\n    }\n  }, {\n    key: \"onDocumentClick\",\n    value: function onDocumentClick(event) {\n      if (this.controlContainer && !this.controlContainer.contains(event.target) && this.mapStyleContainer && this.styleButton) {\n        this.mapStyleContainer.style.display = \"none\";\n        this.styleButton.style.display = \"block\";\n      }\n    }\n  }]);\n\n  return MapboxStyleSwitcherControl;\n}();\n\nMapboxStyleSwitcherControl.DEFAULT_STYLE = \"Streets\";\nMapboxStyleSwitcherControl.DEFAULT_STYLES = [{\n  title: \"Dark\",\n  uri: \"mapbox://styles/mapbox/dark-v10\"\n}, {\n  title: \"Light\",\n  uri: \"mapbox://styles/mapbox/light-v10\"\n}, {\n  title: \"Outdoors\",\n  uri: \"mapbox://styles/mapbox/outdoors-v11\"\n}, {\n  title: \"Satellite\",\n  uri: \"mapbox://styles/mapbox/satellite-streets-v11\"\n}, {\n  title: \"Streets\",\n  uri: \"mapbox://styles/mapbox/streets-v11\"\n}];\nexports.MapboxStyleSwitcherControl = MapboxStyleSwitcherControl;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","import React, { useState, useRef } from 'react'\nimport { render } from 'react-dom'\nimport PropTypes from 'prop-types'\nimport { fromJS } from 'immutable'\n\nimport styled, { css, themeGet } from 'style'\n\nconst Wrapper = styled.div`\n  /* cursor: pointer;\n  position: absolute;\n  left: 10px;\n  bottom: 24px;\n  z-index: 999; */\n`\n\nconst Basemap = styled.img`\n  box-sizing: border-box;\n  border: 2px solid\n    ${({ isActive }) => (isActive ? themeGet('colors.highlight.500') : '#fff')};\n  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  margin: 0;\n\n  ${({ size }) => css`\n    width: ${size};\n    height: ${size};\n    border-radius: ${size};\n  `}\n\n  &:not(:first-child) {\n    margin-left: 0.25rem;\n  }\n`\n\nconst getSrc = ({ styleID, z, x, y, token }) =>\n  `https://api.mapbox.com/styles/v1/mapbox/${styleID}/tiles/256/${z}/${x}/${y}?access_token=${token}`\n\nconst StyleSelector = ({ map, token, styles, tile, size, onChange }) => {\n  console.log('render StyleSelector')\n\n  map.on('style.load', () => {\n    console.log('style load')\n  })\n\n  const [basemap, setBasemap] = useState(styles[0])\n  const [isOpen, setIsOpen] = useState(false)\n  const baseStyleRef = useRef(null)\n\n  map.once('style.load', () => {\n    baseStyleRef.current = fromJS(map.getStyle())\n  })\n\n  const handleBasemapClick = newBasemap => {\n    console.log('handle click', newBasemap)\n    setIsOpen(false)\n\n    if (newBasemap === basemap) return\n\n    setBasemap(newBasemap)\n\n    const { current: baseStyle } = baseStyleRef\n\n    const snapshot = fromJS(map.getStyle())\n    const baseSources = baseStyle.get('sources')\n    const baseLayers = baseStyle.get('layers')\n\n    // diff the sources and layers to find those added by the user\n    const userSources = snapshot\n      .get('sources')\n      .filter((_, key) => !baseSources.has(key))\n    const userLayers = snapshot\n      .get('layers')\n      .filter(layer => !baseLayers.includes(layer))\n\n    map.setStyle(`mapbox://styles/mapbox/${newBasemap}`)\n\n    map.once('style.load', () => {\n      console.log('on style update')\n      // after new style has loaded\n      // save it so that we can diff with it on next change\n      // and re-add the sources / layers back on it\n\n      // save base for new style\n      baseStyleRef.current = fromJS(map.getStyle())\n\n      userSources.forEach((source, id) => {\n        map.addSource(id, source.toJS())\n      })\n\n      userLayers.forEach(layer => {\n        map.addLayer(layer.toJS())\n      })\n\n      onChange(newBasemap)\n    })\n  }\n\n  const toggleOpen = () => {\n    setIsOpen(true)\n  }\n\n  const toggleClosed = () => {\n    setIsOpen(false)\n  }\n\n  // if there are only 2 options, render as a toggle\n  if (styles.length === 2) {\n    const nextBasemap = basemap === styles[0] ? styles[1] : styles[0]\n\n    return (\n      <Wrapper>\n        <Basemap\n          size={size}\n          src={getSrc({ styleID: nextBasemap, token, ...tile })}\n          onClick={() => handleBasemapClick(nextBasemap)}\n        />\n      </Wrapper>\n    )\n  }\n\n  const nextBasemap = styles.filter(style => style !== basemap)[0]\n\n  return (\n    <Wrapper onMouseEnter={toggleOpen} onMouseLeave={toggleClosed}>\n      {isOpen ? (\n        <>\n          <Basemap\n            size={size}\n            src={getSrc({ styleID: nextBasemap, token, ...tile })}\n            onClick={() => handleBasemapClick(nextBasemap)}\n          />\n          {styles\n            .filter(style => style !== nextBasemap)\n            .map(styleID => (\n              <Basemap\n                key={styleID}\n                isActive={styleID === basemap}\n                size={size}\n                src={getSrc({ styleID, token, ...tile })}\n                onClick={() => handleBasemapClick(styleID)}\n              />\n            ))}\n        </>\n      ) : (\n        <Basemap\n          size={size}\n          src={getSrc({ styleID: nextBasemap, token, ...tile })}\n          onClick={toggleOpen}\n        />\n      )}\n    </Wrapper>\n  )\n}\n\nStyleSelector.propTypes = {\n  map: PropTypes.object,\n  token: PropTypes.string.isRequired,\n  // list of mapbox style IDs\n  styles: PropTypes.arrayOf(PropTypes.string).isRequired,\n  tile: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n    z: PropTypes.number.isRequired,\n  }),\n  size: PropTypes.string,\n  onChange: PropTypes.func,\n}\n\nStyleSelector.defaultProps = {\n  map: null,\n  tile: {\n    x: 0,\n    y: 0,\n    z: 0,\n  },\n  size: '64px',\n  onChange: () => {},\n}\n\n// Wrap in a Mapbox GL plugin so that we can construct the above React element on map init\n// TODO: pass props through\nclass Plugin {\n  constructor({ styles, token, position }) {\n    this.styles = styles\n    this.token = token\n    this.position = position\n  }\n\n  onAdd(map) {\n    console.log('onAdd')\n    this.map = map\n\n    const { styles, token } = this\n\n    this.container = document.createElement('div')\n    this.container.classList.add('mapboxgl-ctrl')\n    this.container.classList.add('mapboxgl-ctrl-style-selector')\n    this.container.style.float = 'none !important'\n    this.container.style.cursor = 'pointer'\n\n    render(\n      <StyleSelector map={map} styles={styles} token={token} />,\n      this.container\n    )\n\n    return this.container\n  }\n\n  init() {\n    console.log('init')\n    const { map, styles, token, container } = this\n    render(<StyleSelector map={map} styles={styles} token={token} />, container)\n  }\n\n  onRemove() {\n    this.map = null\n    this.container.parentNode.removeChild(this.container)\n  }\n}\n\nexport default Plugin\n","/* eslint-disable max-len, no-underscore-dangle */\nimport React, { useEffect, useRef, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport mapboxgl from 'mapbox-gl'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport styled from 'style'\nimport { hasWindow } from 'util/dom'\nimport { getCenterAndZoom } from './util'\nimport StyleSelector from './StyleSelector'\nimport MapboxDirections from '@mapbox/mapbox-gl-directions/dist/mapbox-gl-directions'\nimport { MapboxStyleSwitcherControl } from 'mapbox-gl-style-switcher'\nimport 'mapbox-gl-style-switcher/styles.css'\nimport { siteMetadata } from '../../../gatsby-config'\n\n// This wrapper must be positioned relative for the map to be able to lay itself out properly\nconst Wrapper = styled.div`\n  width: ${({ width }) => width};\n  height: ${({ height }) => height};\n  position: relative;\n  flex: 1 0 auto;\n`\n\nconst Map = ({\n  width,\n  height,\n  zoom,\n  center,\n  bounds,\n  padding,\n  styles,\n  sources,\n  layers,\n  minZoom,\n  maxZoom,\n  directions,\n  scale,\n  styleSwitcher,\n  layerSwitcher,\n}) => {\n  const { mapboxToken } = siteMetadata\n\n  if (!mapboxToken) {\n    console.error(\n      'ERROR: Mapbox token is required in gatsby-config.js siteMetadata'\n    )\n  }\n\n  // if there is no window, we cannot render this component\n  if (!hasWindow) {\n    return null\n  }\n\n  // this ref holds the map DOM node so that we can pass it into Mapbox GL\n  const mapNode = useRef(null)\n\n  // this ref holds the map object once we have instantiated it, so that we\n  // can use it in other hooks\n  const mapRef = useRef(null)\n  // construct the map within an effect that has no dependencies\n  // this allows us to construct it only once at the time the\n  // component is constructed.\n  useEffect(() => {\n    let mapCenter = center\n    let mapZoom = zoom\n\n    // If bounds are available, use these to establish center and zoom when map first loads\n    if (bounds && bounds.length === 4) {\n      const { center: boundsCenter, zoom: boundsZoom } = getCenterAndZoom(\n        mapNode.current,\n        bounds,\n        padding\n      )\n      mapCenter = boundsCenter\n      mapZoom = boundsZoom\n    }\n\n    // Token must be set before constructing map\n    mapboxgl.accessToken = mapboxToken\n\n    const map = new mapboxgl.Map({\n      container: mapNode.current,\n      style: `mapbox://styles/mapbox/${styles[0]}`,\n      center: mapCenter,\n      zoom: mapZoom,\n      minZoom,\n      maxZoom,\n    })\n    mapRef.current = map\n    window.map = map // for easier debugging and querying via console\n\n    map.addControl(new mapboxgl.NavigationControl(), 'top-right')\n\n    if (styles.length > 1) {\n      map.addControl(\n        new StyleSelector({\n          styles,\n          token: mapboxToken,\n        }),\n        'bottom-left'\n      )\n    }\n\n    map.on('load', () => {\n      console.log('map onload')\n      // add sources\n\n      Object.entries(sources).forEach(([id, source]) => {\n        map.addSource(id, source)\n      })\n\n      // add layers\n      layers.forEach(layer => {\n        map.addLayer(layer)\n      })\n\n      var direction\n      directions.forEach(directionData => {\n        directionData.pois.forEach(poi => {\n          new mapboxgl.Marker()\n            .setLngLat([poi[0], poi[1]])\n            .setPopup(new mapboxgl.Popup({ offset: 25 }).setText(poi[2]))\n            .addTo(map)\n        })\n        direction = new MapboxDirections(directionData)\n        direction.setOrigin(directionData.origin)\n        direction.setDestination(directionData.destination)\n        map.addControl(direction, 'top-right')\n      })\n\n      scale.forEach(s => {\n        map.addControl(\n          new mapboxgl.ScaleControl({\n            maxWidth: s.maxWidth,\n            unit: s.unit,\n          })\n        )\n      })\n\n      styleSwitcher.forEach(ss => {\n        console.log(ss.styles + ss.position)\n        map.addControl(new MapboxStyleSwitcherControl(ss.styles, ss.position))\n        /*   map.addControl(\n          \n        );*/\n      })\n\n      layerSwitcher.forEach(ls => {\n        console.log(ls)\n      })\n    })\n\n    // hook up map events here, such as click, mouseenter, mouseleave\n    // e.g., map.on('click', (e) => {})\n\n    // when this component is destroyed, remove the map\n    return () => {\n      map.remove()\n    }\n  }, [])\n\n  // You can use other `useEffect` hooks to update the state of the map\n  // based on incoming props.  Just beware that you might need to add additional\n  // refs to share objects or state between hooks.\n\n  return (\n    <Wrapper width={width} height={height}>\n      <div ref={mapNode} style={{ width: '100%', height: '100%' }} />\n      {/* <StyleSelector map={mapRef.current} styles={styles} token={mapboxToken} /> */}\n    </Wrapper>\n  )\n}\n\nMap.propTypes = {\n  width: PropTypes.string,\n  height: PropTypes.string,\n  center: PropTypes.arrayOf(PropTypes.number),\n  zoom: PropTypes.number,\n  bounds: PropTypes.arrayOf(PropTypes.number),\n  minZoom: PropTypes.number,\n  maxZoom: PropTypes.number,\n  styles: PropTypes.arrayOf(PropTypes.string),\n  padding: PropTypes.number,\n  sources: PropTypes.object,\n  layers: PropTypes.arrayOf(PropTypes.object),\n  directions: PropTypes.arrayOf(PropTypes.object),\n  scale: PropTypes.arrayOf(PropTypes.object),\n  styleSwitcher: PropTypes.arrayOf(PropTypes.object),\n  layerSwitcher: PropTypes.arrayOf(PropTypes.object),\n}\n\nMap.defaultProps = {\n  width: 'auto',\n  height: '100%',\n  center: [7.221275, 50.326111],\n  zoom: 9.5,\n  bounds: null,\n  minZoom: 0,\n  maxZoom: 24,\n  styles: ['streets-v11'],\n  padding: 0.1, // padding around bounds as a proportion\n  sources: {},\n  layers: [],\n  directions: [],\n  scale: [],\n  styleSwitcher: [],\n  layerSwitcher: [],\n}\n\nexport default Map\n","import geoViewport from '@mapbox/geo-viewport'\n\n/**\n * Calculate the appropriate center and zoom to fit the bounds, given padding.\n * @param {Element} - map DOM node used to calculate height and width in screen pixels of map\n * @param {Array(number)} bounds - [xmin, ymin, xmax, ymax]\n * @param {float} padding - proportion of calculated zoom level to zoom out by, to pad the bounds\n */\nexport const getCenterAndZoom = (mapNode, bounds, padding = 0) => {\n  const { width, height } = mapNode\n  const viewport = geoViewport.viewport(\n    bounds,\n    [width, height],\n    undefined,\n    undefined,\n    undefined,\n    true\n  )\n\n  // Zoom out slightly to pad around bounds\n\n  const zoom = Math.max(viewport.zoom - 1, 0) * (1 - padding)\n\n  return { center: viewport.center, zoom }\n}\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;"],"sourceRoot":""}