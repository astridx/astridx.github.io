{"version":3,"sources":["webpack:///./node_modules/mapbox-gl-style-switcher/dist/index.js","webpack:///./node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/createClass.js","webpack:///./src/components/Map/StyleSelector.jsx","webpack:///./src/components/Map/index.jsx","webpack:///./src/components/Map/util.js","webpack:///./src/constants/styles.js","webpack:///./src/pages/map-style-switcher.jsx","webpack:///./node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/classCallCheck.js"],"names":["_classCallCheck","_createClass","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","length","i","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","arr","len","arr2","defineProperty","exports","MapboxStyleSwitcherControl","styles","defaultStyle","this","DEFAULT_STYLES","DEFAULT_STYLE","onDocumentClick","bind","key","map","_this","controlContainer","document","createElement","classList","add","mapStyleContainer","styleButton","type","_step","_iterator","style","styleElement","innerText","title","replace","dataset","uri","JSON","stringify","addEventListener","event","srcElement","contains","setStyle","parse","display","elms","getElementsByClassName","remove","appendChild","parentNode","removeEventListener","removeChild","undefined","target","_defineProperties","props","descriptor","enumerable","configurable","writable","module","Constructor","protoProps","staticProps","Wrapper","styled","div","Basemap","img","isActive","themeGet","size","css","getSrc","styleID","z","x","y","token","StyleSelector","tile","onChange","console","log","on","useState","basemap","setBasemap","isOpen","setIsOpen","baseStyleRef","useRef","once","current","fromJS","getStyle","handleBasemapClick","newBasemap","baseStyle","snapshot","baseSources","get","baseLayers","userSources","filter","_","has","userLayers","layer","includes","forEach","source","id","addSource","toJS","addLayer","toggleOpen","nextBasemap","src","onClick","onMouseEnter","onMouseLeave","defaultProps","Plugin","position","onAdd","container","float","cursor","render","init","onRemove","width","height","Map","zoom","center","bounds","padding","sources","layers","minZoom","maxZoom","directions","scale","styleSwitcher","layerSwitcher","mapboxToken","siteMetadata","error","hasWindow","mapNode","mapRef","useEffect","mapCenter","mapZoom","viewport","geoViewport","Math","max","getCenterAndZoom","mapboxgl","accessToken","window","addControl","NavigationControl","direction","entries","directionData","pois","poi","Marker","setLngLat","setPopup","Popup","offset","setText","addTo","MapboxDirections","setOrigin","origin","setDestination","destination","ScaleControl","maxWidth","unit","ss","ls","ref","MapPage","Layout","styleSwitcherData","instance"],"mappings":"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","file":"component---src-pages-map-style-switcher-jsx-c6e404688e823cf5c2b5.js","sourcesContent":["\"use strict\";\n\nvar _classCallCheck = require(\"/home/astrid/git/javascript/gatsby_plugins_starter/gitrepos/gatsby-starter-mapbox-examples/node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/astrid/git/javascript/gatsby_plugins_starter/gitrepos/gatsby-starter-mapbox-examples/node_modules/babel-preset-gatsby/node_modules/@babel/runtime/helpers/createClass\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar MapboxStyleSwitcherControl = /*#__PURE__*/function () {\n  function MapboxStyleSwitcherControl(styles, defaultStyle) {\n    _classCallCheck(this, MapboxStyleSwitcherControl);\n\n    this.styles = styles || MapboxStyleSwitcherControl.DEFAULT_STYLES;\n    this.defaultStyle = defaultStyle || MapboxStyleSwitcherControl.DEFAULT_STYLE;\n    this.onDocumentClick = this.onDocumentClick.bind(this);\n  }\n\n  _createClass(MapboxStyleSwitcherControl, [{\n    key: \"getDefaultPosition\",\n    value: function getDefaultPosition() {\n      var defaultPosition = \"top-right\";\n      return defaultPosition;\n    }\n  }, {\n    key: \"onAdd\",\n    value: function onAdd(map) {\n      var _this = this;\n\n      this.map = map;\n      this.controlContainer = document.createElement(\"div\");\n      this.controlContainer.classList.add(\"mapboxgl-ctrl\");\n      this.controlContainer.classList.add(\"mapboxgl-ctrl-group\");\n      this.mapStyleContainer = document.createElement(\"div\");\n      this.styleButton = document.createElement(\"button\");\n      this.styleButton.type = \"button\";\n      this.mapStyleContainer.classList.add(\"mapboxgl-style-list\");\n\n      var _iterator = _createForOfIteratorHelper(this.styles),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var style = _step.value;\n          var styleElement = document.createElement(\"button\");\n          styleElement.type = \"button\";\n          styleElement.innerText = style.title;\n          styleElement.classList.add(style.title.replace(/[^a-z0-9-]/gi, '_'));\n          styleElement.dataset.uri = JSON.stringify(style.uri);\n          styleElement.addEventListener(\"click\", function (event) {\n            var srcElement = event.srcElement;\n\n            if (srcElement.classList.contains(\"active\")) {\n              return;\n            }\n\n            _this.map.setStyle(JSON.parse(srcElement.dataset.uri));\n\n            _this.mapStyleContainer.style.display = \"none\";\n            _this.styleButton.style.display = \"block\";\n\n            var elms = _this.mapStyleContainer.getElementsByClassName(\"active\");\n\n            while (elms[0]) {\n              elms[0].classList.remove(\"active\");\n            }\n\n            srcElement.classList.add(\"active\");\n          });\n\n          if (style.title === this.defaultStyle) {\n            styleElement.classList.add(\"active\");\n          }\n\n          this.mapStyleContainer.appendChild(styleElement);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.styleButton.classList.add(\"mapboxgl-ctrl-icon\");\n      this.styleButton.classList.add(\"mapboxgl-style-switcher\");\n      this.styleButton.addEventListener(\"click\", function () {\n        _this.styleButton.style.display = \"none\";\n        _this.mapStyleContainer.style.display = \"block\";\n      });\n      document.addEventListener(\"click\", this.onDocumentClick);\n      this.controlContainer.appendChild(this.styleButton);\n      this.controlContainer.appendChild(this.mapStyleContainer);\n      return this.controlContainer;\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove() {\n      if (!this.controlContainer || !this.controlContainer.parentNode || !this.map || !this.styleButton) {\n        return;\n      }\n\n      this.styleButton.removeEventListener(\"click\", this.onDocumentClick);\n      this.controlContainer.parentNode.removeChild(this.controlContainer);\n      document.removeEventListener(\"click\", this.onDocumentClick);\n      this.map = undefined;\n    }\n  }, {\n    key: \"onDocumentClick\",\n    value: function onDocumentClick(event) {\n      if (this.controlContainer && !this.controlContainer.contains(event.target) && this.mapStyleContainer && this.styleButton) {\n        this.mapStyleContainer.style.display = \"none\";\n        this.styleButton.style.display = \"block\";\n      }\n    }\n  }]);\n\n  return MapboxStyleSwitcherControl;\n}();\n\nMapboxStyleSwitcherControl.DEFAULT_STYLE = \"Streets\";\nMapboxStyleSwitcherControl.DEFAULT_STYLES = [{\n  title: \"Dark\",\n  uri: \"mapbox://styles/mapbox/dark-v10\"\n}, {\n  title: \"Light\",\n  uri: \"mapbox://styles/mapbox/light-v10\"\n}, {\n  title: \"Outdoors\",\n  uri: \"mapbox://styles/mapbox/outdoors-v11\"\n}, {\n  title: \"Satellite\",\n  uri: \"mapbox://styles/mapbox/satellite-streets-v11\"\n}, {\n  title: \"Streets\",\n  uri: \"mapbox://styles/mapbox/streets-v11\"\n}];\nexports.MapboxStyleSwitcherControl = MapboxStyleSwitcherControl;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","import React, { useState, useRef } from 'react'\nimport { render } from 'react-dom'\nimport PropTypes from 'prop-types'\nimport { fromJS } from 'immutable'\n\nimport styled, { css, themeGet } from 'style'\n\nconst Wrapper = styled.div`\n  /* cursor: pointer;\n  position: absolute;\n  left: 10px;\n  bottom: 24px;\n  z-index: 999; */\n`\n\nconst Basemap = styled.img`\n  box-sizing: border-box;\n  border: 2px solid\n    ${({ isActive }) => (isActive ? themeGet('colors.highlight.500') : '#fff')};\n  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  margin: 0;\n\n  ${({ size }) => css`\n    width: ${size};\n    height: ${size};\n    border-radius: ${size};\n  `}\n\n  &:not(:first-child) {\n    margin-left: 0.25rem;\n  }\n`\n\nconst getSrc = ({ styleID, z, x, y, token }) =>\n  `https://api.mapbox.com/styles/v1/mapbox/${styleID}/tiles/256/${z}/${x}/${y}?access_token=${token}`\n\nconst StyleSelector = ({ map, token, styles, tile, size, onChange }) => {\n  console.log('render StyleSelector')\n\n  map.on('style.load', () => {\n    console.log('style load')\n  })\n\n  const [basemap, setBasemap] = useState(styles[0])\n  const [isOpen, setIsOpen] = useState(false)\n  const baseStyleRef = useRef(null)\n\n  map.once('style.load', () => {\n    baseStyleRef.current = fromJS(map.getStyle())\n  })\n\n  const handleBasemapClick = newBasemap => {\n    console.log('handle click', newBasemap)\n    setIsOpen(false)\n\n    if (newBasemap === basemap) return\n\n    setBasemap(newBasemap)\n\n    const { current: baseStyle } = baseStyleRef\n\n    const snapshot = fromJS(map.getStyle())\n    const baseSources = baseStyle.get('sources')\n    const baseLayers = baseStyle.get('layers')\n\n    // diff the sources and layers to find those added by the user\n    const userSources = snapshot\n      .get('sources')\n      .filter((_, key) => !baseSources.has(key))\n    const userLayers = snapshot\n      .get('layers')\n      .filter(layer => !baseLayers.includes(layer))\n\n    map.setStyle(`mapbox://styles/mapbox/${newBasemap}`)\n\n    map.once('style.load', () => {\n      console.log('on style update')\n      // after new style has loaded\n      // save it so that we can diff with it on next change\n      // and re-add the sources / layers back on it\n\n      // save base for new style\n      baseStyleRef.current = fromJS(map.getStyle())\n\n      userSources.forEach((source, id) => {\n        map.addSource(id, source.toJS())\n      })\n\n      userLayers.forEach(layer => {\n        map.addLayer(layer.toJS())\n      })\n\n      onChange(newBasemap)\n    })\n  }\n\n  const toggleOpen = () => {\n    setIsOpen(true)\n  }\n\n  const toggleClosed = () => {\n    setIsOpen(false)\n  }\n\n  // if there are only 2 options, render as a toggle\n  if (styles.length === 2) {\n    const nextBasemap = basemap === styles[0] ? styles[1] : styles[0]\n\n    return (\n      <Wrapper>\n        <Basemap\n          size={size}\n          src={getSrc({ styleID: nextBasemap, token, ...tile })}\n          onClick={() => handleBasemapClick(nextBasemap)}\n        />\n      </Wrapper>\n    )\n  }\n\n  const nextBasemap = styles.filter(style => style !== basemap)[0]\n\n  return (\n    <Wrapper onMouseEnter={toggleOpen} onMouseLeave={toggleClosed}>\n      {isOpen ? (\n        <>\n          <Basemap\n            size={size}\n            src={getSrc({ styleID: nextBasemap, token, ...tile })}\n            onClick={() => handleBasemapClick(nextBasemap)}\n          />\n          {styles\n            .filter(style => style !== nextBasemap)\n            .map(styleID => (\n              <Basemap\n                key={styleID}\n                isActive={styleID === basemap}\n                size={size}\n                src={getSrc({ styleID, token, ...tile })}\n                onClick={() => handleBasemapClick(styleID)}\n              />\n            ))}\n        </>\n      ) : (\n        <Basemap\n          size={size}\n          src={getSrc({ styleID: nextBasemap, token, ...tile })}\n          onClick={toggleOpen}\n        />\n      )}\n    </Wrapper>\n  )\n}\n\nStyleSelector.propTypes = {\n  map: PropTypes.object,\n  token: PropTypes.string.isRequired,\n  // list of mapbox style IDs\n  styles: PropTypes.arrayOf(PropTypes.string).isRequired,\n  tile: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n    z: PropTypes.number.isRequired,\n  }),\n  size: PropTypes.string,\n  onChange: PropTypes.func,\n}\n\nStyleSelector.defaultProps = {\n  map: null,\n  tile: {\n    x: 0,\n    y: 0,\n    z: 0,\n  },\n  size: '64px',\n  onChange: () => {},\n}\n\n// Wrap in a Mapbox GL plugin so that we can construct the above React element on map init\n// TODO: pass props through\nclass Plugin {\n  constructor({ styles, token, position }) {\n    this.styles = styles\n    this.token = token\n    this.position = position\n  }\n\n  onAdd(map) {\n    console.log('onAdd')\n    this.map = map\n\n    const { styles, token } = this\n\n    this.container = document.createElement('div')\n    this.container.classList.add('mapboxgl-ctrl')\n    this.container.classList.add('mapboxgl-ctrl-style-selector')\n    this.container.style.float = 'none !important'\n    this.container.style.cursor = 'pointer'\n\n    render(\n      <StyleSelector map={map} styles={styles} token={token} />,\n      this.container\n    )\n\n    return this.container\n  }\n\n  init() {\n    console.log('init')\n    const { map, styles, token, container } = this\n    render(<StyleSelector map={map} styles={styles} token={token} />, container)\n  }\n\n  onRemove() {\n    this.map = null\n    this.container.parentNode.removeChild(this.container)\n  }\n}\n\nexport default Plugin\n","/* eslint-disable max-len, no-underscore-dangle */\nimport React, { useEffect, useRef, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport mapboxgl from 'mapbox-gl'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport styled from 'style'\nimport { hasWindow } from 'util/dom'\nimport { getCenterAndZoom } from './util'\nimport StyleSelector from './StyleSelector'\nimport MapboxDirections from '@mapbox/mapbox-gl-directions/dist/mapbox-gl-directions'\nimport { MapboxStyleSwitcherControl } from 'mapbox-gl-style-switcher'\nimport 'mapbox-gl-style-switcher/styles.css'\nimport { siteMetadata } from '../../../gatsby-config'\n\n// This wrapper must be positioned relative for the map to be able to lay itself out properly\nconst Wrapper = styled.div`\n  width: ${({ width }) => width};\n  height: ${({ height }) => height};\n  position: relative;\n  flex: 1 0 auto;\n`\n\nconst Map = ({\n  width,\n  height,\n  zoom,\n  center,\n  bounds,\n  padding,\n  styles,\n  sources,\n  layers,\n  minZoom,\n  maxZoom,\n  directions,\n  scale,\n  styleSwitcher,\n  layerSwitcher,\n}) => {\n  const { mapboxToken } = siteMetadata\n\n  if (!mapboxToken) {\n    console.error(\n      'ERROR: Mapbox token is required in gatsby-config.js siteMetadata'\n    )\n  }\n\n  // if there is no window, we cannot render this component\n  if (!hasWindow) {\n    return null\n  }\n\n  // this ref holds the map DOM node so that we can pass it into Mapbox GL\n  const mapNode = useRef(null)\n\n  // this ref holds the map object once we have instantiated it, so that we\n  // can use it in other hooks\n  const mapRef = useRef(null)\n  // construct the map within an effect that has no dependencies\n  // this allows us to construct it only once at the time the\n  // component is constructed.\n  useEffect(() => {\n    let mapCenter = center\n    let mapZoom = zoom\n\n    // If bounds are available, use these to establish center and zoom when map first loads\n    if (bounds && bounds.length === 4) {\n      const { center: boundsCenter, zoom: boundsZoom } = getCenterAndZoom(\n        mapNode.current,\n        bounds,\n        padding\n      )\n      mapCenter = boundsCenter\n      mapZoom = boundsZoom\n    }\n\n    // Token must be set before constructing map\n    mapboxgl.accessToken = mapboxToken\n\n    const map = new mapboxgl.Map({\n      container: mapNode.current,\n      style: `mapbox://styles/mapbox/${styles[0]}`,\n      center: mapCenter,\n      zoom: mapZoom,\n      minZoom,\n      maxZoom,\n    })\n    mapRef.current = map\n    window.map = map // for easier debugging and querying via console\n\n    map.addControl(new mapboxgl.NavigationControl(), 'top-right')\n\n    if (styles.length > 1) {\n      map.addControl(\n        new StyleSelector({\n          styles,\n          token: mapboxToken,\n        }),\n        'bottom-left'\n      )\n    }\n\n    map.on('load', () => {\n      console.log('map onload')\n      // add sources\n\n      Object.entries(sources).forEach(([id, source]) => {\n        map.addSource(id, source)\n      })\n\n      // add layers\n      layers.forEach(layer => {\n        map.addLayer(layer)\n      })\n\n      var direction\n      directions.forEach(directionData => {\n        directionData.pois.forEach(poi => {\n          new mapboxgl.Marker()\n            .setLngLat([poi[0], poi[1]])\n            .setPopup(new mapboxgl.Popup({ offset: 25 }).setText(poi[2]))\n            .addTo(map)\n        })\n        direction = new MapboxDirections(directionData)\n        direction.setOrigin(directionData.origin)\n        direction.setDestination(directionData.destination)\n        map.addControl(direction, 'top-right')\n      })\n\n      scale.forEach(s => {\n        map.addControl(\n          new mapboxgl.ScaleControl({\n            maxWidth: s.maxWidth,\n            unit: s.unit,\n          })\n        )\n      })\n\n      styleSwitcher.forEach(ss => {\n        console.log(ss.styles + ss.position)\n        map.addControl(new MapboxStyleSwitcherControl(ss.styles, ss.position))\n        /*   map.addControl(\n          \n        );*/\n      })\n\n      layerSwitcher.forEach(ls => {\n        console.log(ls)\n      })\n    })\n\n    // hook up map events here, such as click, mouseenter, mouseleave\n    // e.g., map.on('click', (e) => {})\n\n    // when this component is destroyed, remove the map\n    return () => {\n      map.remove()\n    }\n  }, [])\n\n  // You can use other `useEffect` hooks to update the state of the map\n  // based on incoming props.  Just beware that you might need to add additional\n  // refs to share objects or state between hooks.\n\n  return (\n    <Wrapper width={width} height={height}>\n      <div ref={mapNode} style={{ width: '100%', height: '100%' }} />\n      {/* <StyleSelector map={mapRef.current} styles={styles} token={mapboxToken} /> */}\n    </Wrapper>\n  )\n}\n\nMap.propTypes = {\n  width: PropTypes.string,\n  height: PropTypes.string,\n  center: PropTypes.arrayOf(PropTypes.number),\n  zoom: PropTypes.number,\n  bounds: PropTypes.arrayOf(PropTypes.number),\n  minZoom: PropTypes.number,\n  maxZoom: PropTypes.number,\n  styles: PropTypes.arrayOf(PropTypes.string),\n  padding: PropTypes.number,\n  sources: PropTypes.object,\n  layers: PropTypes.arrayOf(PropTypes.object),\n  directions: PropTypes.arrayOf(PropTypes.object),\n  scale: PropTypes.arrayOf(PropTypes.object),\n  styleSwitcher: PropTypes.arrayOf(PropTypes.object),\n  layerSwitcher: PropTypes.arrayOf(PropTypes.object),\n}\n\nMap.defaultProps = {\n  width: 'auto',\n  height: '100%',\n  center: [7.221275, 50.326111],\n  zoom: 9.5,\n  bounds: null,\n  minZoom: 0,\n  maxZoom: 24,\n  styles: ['streets-v11'],\n  padding: 0.1, // padding around bounds as a proportion\n  sources: {},\n  layers: [],\n  directions: [],\n  scale: [],\n  styleSwitcher: [],\n  layerSwitcher: [],\n}\n\nexport default Map\n","import geoViewport from '@mapbox/geo-viewport'\n\n/**\n * Calculate the appropriate center and zoom to fit the bounds, given padding.\n * @param {Element} - map DOM node used to calculate height and width in screen pixels of map\n * @param {Array(number)} bounds - [xmin, ymin, xmax, ymax]\n * @param {float} padding - proportion of calculated zoom level to zoom out by, to pad the bounds\n */\nexport const getCenterAndZoom = (mapNode, bounds, padding = 0) => {\n  const { width, height } = mapNode\n  const viewport = geoViewport.viewport(\n    bounds,\n    [width, height],\n    undefined,\n    undefined,\n    undefined,\n    true\n  )\n\n  // Zoom out slightly to pad around bounds\n\n  const zoom = Math.max(viewport.zoom - 1, 0) * (1 - padding)\n\n  return { center: viewport.center, zoom }\n}\n","export default [\n  {\n    title: 'Dark',\n    uri: 'mapbox://styles/mapbox/dark-v9',\n  },\n  {\n    title: 'Light',\n    uri: 'mapbox://styles/mapbox/light-v9',\n  },\n  {\n    title: 'Streets',\n    uri: 'mapbox://styles/mapbox/streets-v11',\n  },\n  {\n    title: 'Satellite',\n    uri: 'mapbox://styles/mapbox/satellite-v9',\n  },\n]\n","import React from 'react'\n\nimport Layout from 'components/Layout'\nimport Map from 'components/Map'\nimport '@mapbox/mapbox-gl-directions/dist/mapbox-gl-directions.css'\nimport styleSwitcherData from '../constants/styles'\n\n// https://www.npmjs.com/package/mapbox-gl-style-switcher\nconst MapPage = () => {\n  return (\n    <Layout title=\"Full Screen Map with Route\">\n      <Map\n        styleSwitcher={[{ styles: styleSwitcherData, position: 'top-left' }]}\n        /*styles={ ['streets-v11', 'light-v9', 'dark-v9', 'satellite-v9']}*/\n      />\n    </Layout>\n  )\n}\n\nexport default MapPage\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;"],"sourceRoot":""}